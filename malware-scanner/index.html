<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Malware Scanner - CyberSec Suite</title>
    <link rel="icon" type="image/png" sizes="32x32" href="../images/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../images/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="../images/apple-touch-icon.png">
    <link rel="manifest" href="../site.webmanifest">
    <link rel="stylesheet" href="../shared-tool-styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <nav>
            <a href="../index.html" class="nav-brand">CyberSec Suite</a>
            <div class="nav-links">
                <a href="../index.html">Home</a>
                <a href="https://github.com/Kompelli-Anurudh/CyberSec-Suite" target="_blank" rel="noopener noreferrer">GitHub</a>
            </div>
        </nav>
    </header>

    <main>
        <div class="tool-container">
            <h2>YARA Malware Scanner</h2>
            
            <div class="scan-section">
                <h3>File Selection</h3>
                <div class="file-input">
                    <input type="file" id="file-input" multiple>
                    <label for="file-input" class="file-label">Choose Files to Scan</label>
                    <p id="selected-files">No files selected</p>
                </div>

                <div class="rules-section">
                    <h3>YARA Rules</h3>
                    <div class="rules-editor">
                        <textarea id="yara-rules" placeholder="Enter or paste YARA rules here...">// Basic Malware Detection Rules

rule SuspiciousExecutable {
    meta:
        description = "Detects suspicious characteristics in executables"
        severity = "medium"
    strings:
        $s1 = "cmd.exe" nocase
        $s2 = "powershell.exe" nocase
        $s3 = "rundll32.exe" nocase
        $suspicious_apis = {
            48 83 EC ?? 48 8B 05 ?? ?? ?? ?? 48 33 C4 48 89 84 24 ?? ?? ?? ??  // API call pattern
        }
        $shellcode = {
            55 8B EC 83 C4 ?? 53 56 57 // Common shellcode header
        }
    condition:
        uint16(0) == 0x5A4D and // MZ header
        (2 of ($s*) or $suspicious_apis or $shellcode)
}

rule RansomwareIndicators {
    meta:
        description = "Detects common ransomware behaviors"
        severity = "high"
    strings:
        $encrypt1 = "CryptoAPI" nocase
        $encrypt2 = "AES_" ascii wide
        $encrypt3 = ".encrypted" nocase
        $encrypt4 = "your files have been" ascii wide
        $encrypt5 = "bitcoin" ascii wide
        $registry = "CurrentVersion\\Run" wide ascii
    condition:
        3 of them
}

rule SuspiciousScripts {
    meta:
        description = "Detects suspicious script characteristics"
        severity = "medium"
    strings:
        $ps1 = "powershell -enc" nocase
        $ps2 = "Invoke-Expression" nocase
        $ps3 = "IEX" nocase
        $vbs1 = "WScript.Shell" nocase
        $vbs2 = "CreateObject" nocase
        $js1 = "eval(" nocase
        $js2 = "document.write(unescape" nocase
    condition:
        2 of them
}

rule NetworkExfiltration {
    meta:
        description = "Detects potential data exfiltration patterns"
        severity = "high"
    strings:
        $url1 = "http://" nocase
        $url2 = "https://" nocase
        $net1 = "Socket" nocase
        $net2 = "Connect" nocase
        $data1 = "password" nocase
        $data2 = "credential" nocase
        $data3 = ".doc" nocase
        $data4 = ".pdf" nocase
    condition:
        (2 of ($url*) or 2 of ($net*)) and 2 of ($data*)
}

rule Keylogger {
    meta:
        description = "Detects potential keylogging functionality"
        severity = "high"
    strings:
        $api1 = "GetAsyncKeyState" nocase
        $api2 = "GetKeyboardState" nocase
        $api3 = "SetWindowsHookEx" nocase
        $log1 = "keylog" nocase
        $log2 = ".log" nocase
    condition:
        2 of ($api*) and any of ($log*)
}</textarea>
                        <div class="rules-buttons">
                            <button id="load-rules" class="secondary-btn">Load Rules File</button>
                            <button id="save-rules" class="secondary-btn">Save Rules</button>
                        </div>
                    </div>
                </div>

                <div class="scan-options">
                    <label>
                        <input type="checkbox" id="recursive-scan" checked>
                        Scan Directories Recursively
                    </label>
                    <label>
                        <input type="checkbox" id="quick-scan">
                        Quick Scan (File Headers Only)
                    </label>
                </div>

                <div class="action-buttons">
                    <button id="start-scan" class="primary-btn">Start Scan</button>
                    <button id="stop-scan" class="secondary-btn" disabled>Stop Scan</button>
                </div>
            </div>

            <div class="progress-section">
                <h3>Scan Progress</h3>
                <div class="progress-container">
                    <div class="progress-bar">
                        <div id="progress-indicator"></div>
                    </div>
                    <p id="status-text">Ready</p>
                    <p id="scan-stats">
                        Files Scanned: <span id="files-scanned">0</span> |
                        Threats Found: <span id="threats-found">0</span>
                    </p>
                </div>
            </div>

            <div class="results-section">
                <h3>Scan Results</h3>
                <div class="results-container">
                    <div class="results-header">
                        <span class="col-file">File</span>
                        <span class="col-rule">Matching Rule</span>
                        <span class="col-threat">Threat Level</span>
                    </div>
                    <div id="scan-results" class="results-body">
                        <!-- Results will be populated here -->
                    </div>
                </div>
            </div>

            <div class="export-container">
                <button id="export-json" class="secondary-btn" disabled>Export Results (JSON)</button>
            </div>

            <!-- Info Section -->
            <div class="info-section">
                <h3>Security Information</h3>
                <ul>
                    <li>All file scanning is performed locally in your browser</li>
                    <li>Files are never uploaded to any server</li>
                    <li>Uses YARA rules for pattern matching</li>
                    <li>Supports custom rule definitions</li>
                    <li>Scan results are stored only in browser memory</li>
                    <li>Compatible with various file types and formats</li>
                </ul>
            </div>
        </div>
    </main>

    <footer>
        <p>&copy; 2024 CyberSec Suite. All rights reserved.</p>
    </footer>

    <script src="script.js"></script>
</body>
</html>